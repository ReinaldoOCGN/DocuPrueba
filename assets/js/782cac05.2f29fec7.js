"use strict";(globalThis.webpackChunkdocuwebema=globalThis.webpackChunkdocuwebema||[]).push([[9902],{1762(e,n,r){r.r(n),r.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"doc-webema-prue/controlador","title":"Controlador","description":"En la carpeta Controllers se encuentra el controlador principal, encargado de gestionar las solicitudes del usuario.","source":"@site/docs/doc-webema-prue/controlador.md","sourceDirName":"doc-webema-prue","slug":"/doc-webema-prue/controlador","permalink":"/Documentacion/next/doc-webema-prue/controlador","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/doc-webema-prue/controlador.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Clases","permalink":"/Documentacion/next/doc-webema-prue/clases"},"next":{"title":"layout","permalink":"/Documentacion/next/doc-webema-prue/layout"}}');var s=r(4848),a=r(8453);const t={sidebar_position:5},l="Controlador",i={},d=[{value:"HomeController",id:"homecontroller",level:2},{value:"MantenedorController",id:"mantenedorcontroller",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"controlador",children:"Controlador"})}),"\n",(0,s.jsxs)(n.p,{children:["En la carpeta ",(0,s.jsx)(n.code,{children:"Controllers"})," se encuentra el controlador principal, encargado de gestionar las solicitudes del usuario."]}),"\n",(0,s.jsx)(n.h2,{id:"homecontroller",children:"HomeController"}),"\n",(0,s.jsx)(n.admonition,{title:"Actualizaci\xf3n de controlador",type:"info",children:(0,s.jsxs)(n.p,{children:["El ",(0,s.jsx)(n.code,{children:"HomeController"})," ahora solo se encarga de la navegaci\xf3n del layout.\r\nSe a\xf1adieron los m\xe9todos ",(0,s.jsx)(n.code,{children:"Index"})," y ",(0,s.jsx)(n.code,{children:"Privacy"}),"."]})}),"\n",(0,s.jsx)(n.p,{children:"En esta nueva versi\xf3n:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Index()"})," \u2192 Muestra la p\xe1gina principal"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Privacy()"})," \u2192 Muestra la p\xe1gina de privacidad"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="HomeControllers.cs"',children:"using Microsoft.AspNetCore.Mvc;\r\nusing System.Data;\r\nusing MostrarEma.Clases;\r\nusing MostrarEma.Models;\r\n\r\nnamespace MostrarEma.Controllers\r\n{\r\n    public class HomeController : Controller\r\n    {\r\n        private readonly ILogger<HomeController> _logger;\r\n\r\n        public HomeController(ILogger<HomeController> logger)\r\n        {\r\n            _logger = logger;\r\n        }\r\n        public IActionResult Index()\r\n        {\r\n            return View();\r\n        }\r\n        public IActionResult Privacy()\r\n        {\r\n            return View();\r\n        }\r\n\r\n    }\r\n}\n"})}),"\n",(0,s.jsx)(n.admonition,{title:"Nuevo controlador agregado",type:"tip",children:(0,s.jsxs)(n.p,{children:["Se agreg\xf3 el ",(0,s.jsx)(n.code,{children:"MantenedorController"})," para gestionar la obtenci\xf3n de usuarios\r\ndesde la base de datos mediante una consulta directa con ADO.NET."]})}),"\n",(0,s.jsx)(n.h2,{id:"mantenedorcontroller",children:"MantenedorController"}),"\n",(0,s.jsx)(n.p,{children:"Este controlador expone el m\xe9todo:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"Listar()"})," \u2192 Devuelve un ",(0,s.jsx)(n.code,{children:"JsonResult"})," con la lista de usuarios."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="MantenedorControllers.cs"',children:'using Microsoft.AspNetCore.Mvc;\r\nusing MostrarEma.Datos;\r\nusing MostrarEma.Models;\r\nusing MostrarEma.Clases;\r\nusing MostrarEma.Models;\r\nusing System.Data;\r\nusing System.Data.SqlClient;\r\n\r\nnamespace MostrarEma.Controllers\r\n{\r\n    public class MantenedorController : Controller\r\n    {\r\n        [HttpGet]\r\n        public JsonResult Listar()\r\n        {\r\n            List<EmaUsuariosModel> oLista = new List<EmaUsuariosModel>();\r\n            var cn = new Conexion();\r\n\r\n            using (var conexion = new SqlConnection(cn.getCadenaSQL()))\r\n            {\r\n                conexion.Open();\r\n\r\n                SqlCommand cmd = new SqlCommand("SELECT  UsuTipIde,UsuIde,UsuClave,UsuTempClave,UsuTerminos,UsuAuten,UsuFecAut,UsuAsegurador,UsuRegimen,UsuPoblacion FROM EmaUsuario", conexion);\r\n                cmd.CommandType = CommandType.Text;\r\n\r\n                using (var dr = cmd.ExecuteReader())\r\n                {\r\n                    while (dr.Read())\r\n                    {\r\n                        oLista.Add(new EmaUsuariosModel()\r\n                        {\r\n                            UsuTipIde = dr["UsuTipIde"].ToString(),\r\n                            UsuIde = dr["UsuIde"].ToString(),\r\n                            UsuClave = dr["UsuClave"].ToString(),\r\n                            UsuTempClave = dr["UsuTempClave"].ToString(),\r\n                            UsuTerminos = dr["UsuTerminos"].ToString(),\r\n                            UsuAuten = dr["UsuAuten"].ToString(),\r\n                            UsuFecAut = dr["UsuFecAut"].ToString(),\r\n                            UsuAsegurador = dr["UsuAsegurador"].ToString(),\r\n                            UsuRegimen = dr["UsuRegimen"].ToString(),\r\n                            UsuPoblacion = dr["UsuPoblacion"].ToString()\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            return Json(new { data = oLista });\r\n        }\r\n    }\r\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,r){r.d(n,{R:()=>t,x:()=>l});var o=r(6540);const s={},a=o.createContext(s);function t(e){const n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);